CREATE TABLE DEPT
       (DEPTNO int not null constraint DEPT_deptno_pk1 primary key,
        DNAME VARCHAR(14) CONSTRAINT DEPT_Dname_UNQ UNIQUE,
        LOC VARCHAR(13) )

INSERT INTO DEPT VALUES (10, 'ACCOUNTING', 'NEW YORK');
INSERT INTO DEPT VALUES (20, 'RESEARCH',   'NEW YORK');
INSERT INTO DEPT VALUES (30, 'SALES',      'BOSTON');
INSERT INTO DEPT VALUES (40, 'OPERATIONS', 'BOSTON');

CREATE TABLE EMP
       (EMPNO int NOT NULL CONSTRAINT EMP_EMPNO_PK PRIMARY KEY,
        ENAME VARCHAR(30),
        JOB VARCHAR(9),
        MGR int CONSTRAINT EMP_MGR_SK REFERENCES EMP(EMPNO),
        HIREDATE DATETIME,
        SAL NUmeric(7, 2),
        COMM Numeric(7, 2),
        DEPTNO int CONSTRAINT EMP_DEPTNO_FK REFERENCES DEPT(DEPTNO))

INSERT INTO EMP VALUES
        (7839, 'KING',   'PRESIDENT', NULL, '11/17/1981' , 5000, NULL, null)
INSERT INTO EMP VALUES
        (7566, 'JONES',  'MANAGER',   7839, '04/2/1981',  2975, NULL, 20)
INSERT INTO EMP VALUES
        (7698, 'BLAKE',  'MANAGER',   7839,'05/01/1985',  2975, NULL, 30)
INSERT INTO EMP VALUES
        (7782, 'CLARK',  'MANAGER',   7839, '06/09/1985',  2450, NULL, 10)
INSERT INTO EMP VALUES
        (7999, 'JOHN_MILLER', 'MANAGER',  7839, '01/01/2011' , 4000, NULL, 10)
INSERT INTO EMP VALUES
        (7788, 'SCOTT',  'ANALYST',   7566, '12/09/1982' , 3000, NULL, 20)
INSERT INTO EMP VALUES
        (7902, 'FORD',   'ANALYST',   7566, '12/03/1981' ,  3000, NULL, 20)
INSERT INTO EMP VALUES
        (7499, 'ALLEN',  'SALESMAN',  7698,'02/20/1985', 1600,  300, 30)
INSERT INTO EMP VALUES
        (7521, 'WARD',   'SALESMAN',  7698, '02/22/1981', 1250,  500, 30)
INSERT INTO EMP VALUES
        (7654, 'MARTIN', 'SALESMAN',  7698, '09/28/1991', 1250, 1400, 30)
INSERT INTO EMP VALUES
        (7844, 'TURNER', 'SALESMAN',  7698, '09/08/1985' ,  1500,    0, 30)
INSERT INTO EMP VALUES
        (7900, 'JAMES',  'CLERK',     7698, '12/03/1981' ,   950, NULL, 30)
INSERT INTO EMP VALUES
        (7369, 'SMITH',  'CLERK',     7902, '12/17/1980', 800, NULL, 20)
INSERT INTO EMP VALUES
        (7876, 'ADAMS',  'CLERK',     7788, ' 01/12/2003', 1100, NULL, 20)
INSERT INTO EMP VALUES
        (7934, 'MILLER', 'CLERK',     7782, '01/23/2003' , 1300, NULL, 10)

select * from dept;
select * from emp;

CREATE TABLE USERDATA (
USERNAME VARCHAR(20) PRIMARY KEY,
PASSWORD VARCHAR(20) NOT NULL
)

INSERT INTO USERDATA VALUES ('ADMIN','123')
INSERT INTO USERDATA VALUES ('USER1','123')
INSERT INTO USERDATA VALUES ('USER2','123')

SELECT * FROM USERDATA;


select * from userdata where USERNAME='admin' and PASSWORD='123'

select count(*) from userdata where USERNAME='admin' and PASSWORD='123'

select * from emp;

insert into emp (empno, ename, hiredate, sal) values (1,'bhavana',getdate(),3000);

insert into emp (empno, ename) values (1,'vishal');


select * from emp;

CREATE PROCEDURE INSERT_EMP (@empno INT, @ename VARCHAR(20), @hiredate DATETIME, @sal NUMERIC(10,2)) AS
BEGIN
    INSERT INTO EMP (EMPNO, ENAME, HIREDATE, SAL) VALUES (@EMPNO, @ENAME, @HIREDATE, @SAL)
END

exec INSERT_EMP 101,'aaa',null,3000

select * from emp;


--write a procedure which takes deptno as param and display all emps for that deptno

CREATE PROC GETEMPSBYDEPT(@DEPTNO INT) AS
BEGIN
    SELECT EMPNO, ENAME, HIREDATE, SAL FROM EMP WHERE DEPTNO = @DEPTNO
END

EXEC GETEMPSBYDEPT 10
